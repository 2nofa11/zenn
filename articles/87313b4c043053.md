---
title: "VueRouterã§ãƒ‘ã‚¹ã®ä¸€éƒ¨ã¨ã—ã¦å®šç¾©ã•ã‚Œã¦ã„ãªã„Paramsã‚’æ¸¡ã™ã¨ã€å€¤ãŒæ¶ˆå¤±ã™ã‚‹"
emoji: "ğŸ¤¦â€â™‚ï¸"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Vue", "TypeScript", "VueRouter"]
published: true
---

# VueRouter ã§ãƒ‘ã‚¹ã®ä¸€éƒ¨ã¨ã—ã¦å®šç¾©ã•ã‚Œã¦ã„ãªã„ Params ã‚’æ¸¡ã™ã¨ã€å€¤ãŒæ¶ˆå¤±ã™ã‚‹

## äº‹è±¡

Vue Router ã§ãƒ‘ã‚¹ã®ä¸€éƒ¨ã¨ã—ã¦å®šç¾©ã•ã‚Œã¦ã„ãªã„ params ã‚’æ¸¡ãã†ã¨ã—ãŸã¨ãã€
ä»¥ä¸‹ã®è­¦å‘ŠãŒç™ºç”Ÿã—ã¦ã€å—ã‘æ¸¡ã—ãŸ Params ã®å€¤ãŒ`undefined`ã«ãªã£ã¦ã„ã¾ã—ãŸã€‚

### ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸã‚³ãƒ¼ãƒ‰

#### å—æ¸¡å…ƒ

```ts
router.push({ name: "somewhere", params: { hoge: "i am params" } });
```

#### router.ts

```ts
{
  path: "/somewhere/",
  name: "somewhere",
  component: somewhere,
  props: (route: RouteLocationNormalized) => ({ id: route.params.hoge }),
},
```

#### å—æ¸¡å…ˆ

```ts
import { useRoute } from "vue-router";
const route = useRoute();
const q = route.params.id;
```

### ã‚¨ãƒ©ãƒ¼å†…å®¹

> [Vue Router warn]: Discarded invalid param(s) "q" when navigating. See https://github.com/vuejs/router/blob/main/packages/router/CHANGELOG.md#414-2022-08-22 for more details.

## ã‚¨ãƒ©ãƒ¼è¦ç´„

### çµè«–

Vue Router v4.1.4 ã‹ã‚‰[ãƒ‘ã‚¹ã®ä¸€éƒ¨ã¨ã—ã¦å®šç¾©ã•ã‚Œã¦ã„ãªã„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æ¸¡ã™]ã“ã¨ã¯å»ƒæ­¢ã«ãªã‚Šã¾ã—ãŸã€‚  
ä»£æ›¿æ‰‹æ®µã¨ã—ã¦ã¯ä»¥ä¸‹ã‚’ä½¿ã£ã¦ãã ã•ã„ã¨ã®ã“ã¨ã€‚

1. ã‚¹ãƒˆã‚¢ã«ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã™ã‚‹
2. ãƒ«ãƒ¼ãƒˆã®ãƒ‘ã‚¹ã«ãƒ‡ãƒ¼ã‚¿ã‚’å®šç¾©ã™ã‚‹ã‹ã€ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦æ¸¡ã™
3. History API state ã«ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹
4. ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚¬ãƒ¼ãƒ‰ã®ãªã‹ã§ to.meta ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã™

### èƒŒæ™¯

#### å‚è€ƒæ–‡çŒ®å†…å®¹

> This change will break your app. This behavior has worked in some scenarios but has been **advised against** for years as it's an anti-pattern in routing for many reasons, one of them being reloading the page lose the params.

#### è¦ç´„

ã“ã®å¤‰æ›´ã«ã‚ˆã£ã¦ã‚¢ãƒ—ãƒªãŒå£Šã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®æŒ¯ã‚‹èˆã„ã¯ä¸€éƒ¨ã®ã‚·ãƒŠãƒªã‚ªã§æ©Ÿèƒ½ã—ã¦ã„ã¾ã—ãŸãŒã€ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã«ãŠã„ã¦åãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã•ã‚Œã¦ãŠã‚Šã€ãƒšãƒ¼ã‚¸ã®å†èª­ã¿è¾¼ã¿ã«ã‚ˆã‚Šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒå¤±ã‚ã‚Œã‚‹ãŸã‚ã€å¤šãã®ç†ç”±ã‹ã‚‰é•·å¹´ã«ã‚ãŸã£ã¦æ¨å¥¨ã•ã‚Œã¦ã„ã¾ã›ã‚“ã§ã—ãŸã€‚

### ä»£æ›¿æ‰‹æ®µ

#### ã‚¹ãƒˆã‚¢ã«ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã•ã›ã‚‹

Pinia ãªã©ã®çŠ¶æ…‹ç®¡ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã„ã¾ã—ã‚‡ã†ã€‚

#### ãƒ«ãƒ¼ãƒˆã®ãƒ‘ã‚¹ã«ãƒ‡ãƒ¼ã‚¿ã‚’å®šç¾©ã™ã‚‹ã‹ã€ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦æ¸¡ã™

router.ts ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰ãˆã‚‹

#### router.ts

```ts
{
  path: "/somewhere/:id",
  name: "somewhere",
  component: somewhere,
  props: (route: RouteLocationNormalized) => ({ id: route.params.hoge }),
},
```

#### History API state ã«ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹

æ–‡çŒ®ã«ã‚ˆã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ã‘ã°æ¸¡ã›ã‚‹ï¼ˆå‹•ä½œæœªç¢ºèªï¼‰

[`state` to save it to the History API state](https://router.vuejs.org/api/interfaces/routelocationoptions.html#state)

```ts
<router-link :to="{ name: 'somewhere', state: { myData } }">...</router-link>
<button
  @click="$router.push({ name: 'somewhere', state: { myData } })"
>...</button>
```

#### ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚¬ãƒ¼ãƒ‰ã®ãªã‹ã§ to.meta ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã™

å‚è€ƒæ–‡çŒ®ã®ä»¥ä¸‹ã‚³ãƒ¼ãƒ‰ã®ã‚ˆã†ã«ã™ã‚‹

```ts
router.beforeEach(async (to) => {
  if (to.meta.shouldFetch) {
    // name `data` whatever you want
    to.meta.data = await fetchSomething();
  }
});
```

## å‚è€ƒæ–‡çŒ®

https://qiita.com/Engineer_Grotle/items/66d181309a779ce8a34a

https://github.com/vuejs/router/blob/main/packages/router/CHANGELOG.md#414-2022-08-22
