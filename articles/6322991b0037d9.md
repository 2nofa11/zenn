---

title: "Vueã®çŠ¶æ…‹ç®¡ç†'Pinia'å…¥é–€"
emoji: "ğŸ”–"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Vue","Pinia","Vuex"]
published: false
---



## Piniaã¨ã¯ä½•ã‹ã€ã©ã‚“ãªç‰¹å¾´ã‚„åˆ©ç‚¹ãŒã‚ã‚‹ã‹

### What's Pinia?

å…¬å¼ã®ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã«è¨˜è¼‰ãŒã‚ã‚‹é€šã‚Šã€`The intuitive store for Vue.js`ï¼ˆVue.jsã®ç›´è¦³çš„ãªã‚¹ãƒˆã‚¢ï¼‰ã§ã™ã€‚

ä¸»ãªç‰¹å¾´ã‚„åˆ©ç‚¹ã¨ã—ã¦ã¯ã€å…¬å¼ã§ã¯ä»¥ä¸‹ãŒæŒ™ã’ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚

* ğŸ’¡ ç›´æ„Ÿçš„
* ğŸ”‘ å‹ ã‚»ãƒ¼ãƒ•

* âš™ï¸ é–‹ç™ºãƒ„ãƒ¼ãƒ«ã®ã‚µãƒãƒ¼ãƒˆ

* ğŸ”Œ æ‹¡å¼µ

* ğŸ— è¨­è¨ˆã«ã‚ˆã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å¼

* ğŸ“¦ éå¸¸ã«è»½ã„

æŒ™ã’ã‚‰ã‚Œã¦ã¦ã¯ã„ã‚‹ã‚‚ã®ã®ã€ç™¾èã¯ä¸€è¦‹ã«å¦‚ã‹ãšã€‚
å®Ÿéš›ã«ä½¿ã£ã¦ã¿ã¦å‹•ä½œã‚’ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

### ãã‚‚ãã‚‚ã‚¹ãƒˆã‚¢ã¨ã¯ï¼Ÿ

ã‚¹ãƒˆã‚¢ã¨ã¯ã€çŠ¶æ…‹ã‚’ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä¿æŒã™ã‚‹å ´æ‰€ã®ã“ã¨ã§ã™ã€‚

ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºã§ã¯ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå˜ä½ã§è¨­è¨ˆã‚’è¡Œã„ã¾ã™ãŒã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåŒå£«ã§å€¤ã®ã‚„ã‚Šå–ã‚Šã‚’ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã€ãã®çŠ¶æ…‹ã‚’ä¼ãˆã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

ãã“ã®æ‰‹æ®µã®ä¸€ã¤ã¨ã—ã¦ã€ã‚¹ãƒˆã‚¢ã‚’ç”¨ã„ã¾ã™ã€‚

è©³ã—ãã¯[ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã€ŒçŠ¶æ…‹ã€ã®å…¥é–€ (zenn.dev)](https://zenn.dev/shava2c/articles/ae668b689be50d)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

ã“ã“ã§ã¯ã€Vuexã®ç´¹ä»‹ã‚’èª¬æ˜ã—ã¦ã„ã¾ã™ãŒã€Vuexã§ã¯4ã¤ã«åˆ†é¡ã—ã¦ã„ã‚‹ã“ã¨ã§æ§‹é€ åŒ–ã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚

* ã‚¹ãƒ†ãƒ¼ãƒˆï¼šçŠ¶æ…‹ãƒ‡ãƒ¼ã‚¿
* ã‚²ãƒƒã‚¿ãƒ¼ï¼šæ´¾ç”Ÿãƒ‡ãƒ¼ã‚¿
* ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ï¼šçŠ¶æ…‹ã‚’å¤‰æ›´ã™ã‚‹
* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼šFetchç­‰ã®çŠ¶æ…‹ã®å¤‰æ›´ä»¥å¤–ã‚’å®Ÿè¡Œã™ã‚‹

https://zenn.dev/shava2c/articles/ae668b689be50d

### Piniaã®ç¾çŠ¶

[UIT Survey 2022 å®Ÿæ–½ãƒ¬ãƒãƒ¼ãƒˆ (linecorp.com)](https://engineering.linecorp.com/ja/blog/uit-survey2022-report)ã«ã¦ã€ã€ŒVue ã§ã®çŠ¶æ…‹ç®¡ç†ã®ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®çµŒé¨“ã€ã®é …ç›®ãŒå­˜åœ¨ã—ã¦ã„ã¾ã—ãŸã€‚

ãã®ä¸­ã§Piniaã¯ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¦ã—ã°ã‚‰ããŸã¤ã«ã‚‚é–¢ã‚ã‚‰ãšã€ã€Œèã„ãŸã“ã¨ãŒãªã„ã€ãŒåŠåˆ†è¿‘ãã„ã‚‹çŠ¶æ…‹ã§ã™ã€‚

https://vos.line-scdn.net/landpress-content-v2_1761/1676880832595.png?updatedAt=1676880835000

ã¾ãŸã€ã€ŒVue ã§ã®çŠ¶æ…‹ç®¡ç†ã®ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä½¿ç”¨ã€ã®é …ç›®ã§ã¯ã€10%ç¨‹åº¦ã¨Vue3ã¸ã®ç§»è¡ŒãŒé¨’ãŒã‚Œã‚‹ä¸­ã€ãªã‹ãªã‹æµ¸é€ã•ã‚Œã¦ã„ãªã„çŠ¶æ…‹ã¨ã„ã†ç¾å®ŸãŒã‚ã‚Šã¾ã™ã€‚

https://vos.line-scdn.net/landpress-content-v2_1761/1676880832556.png?updatedAt=1676880834000

## Piniaã®åŸºæœ¬çš„ãªä½¿ã„æ–¹ã‚„ã‚³ãƒ¼ãƒ‰ä¾‹

### ã‚¹ãƒˆã‚¢å´ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ–¹æ³•

Vue3ã¨åŒæ§˜ã«Option Storesã¨Setup Stores2ã¤ã®æ–¹å¼ãŒå­˜åœ¨ã—ã¾ã™ã€‚  
æ›¸ãå¿ƒåœ°ã¨ã—ã¦ã¯Setup StoresãŒã„ã„ã‹ãªã¨æ€ã†ã®ã§ã™ãŒã€ãƒãƒ¼ãƒ ã«ã‚ˆã‚‹ã¨æ€ã„ã¾ã™ã€‚

ä¾‹ãˆã°ã€ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã¨ã„ã†çŠ¶æ…‹ã‚’æŒã¤å ´åˆã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ã‚¹ãƒ†ãƒ¼ãƒˆã€ã‚²ãƒƒã‚¿ãƒ¼ã€ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®šç¾©ã—ã¾ã™ã€‚

* Option Stores

  ```ts
  export const useCounterStore = defineStore('counter', {
    state: () => ({ count: 0, name: 'Eduardo' }),
    getters: {
      doubleCount: (state) => state.count * 2,
    },
    actions: {
      increment() {
        this.count++
      },
    },
  })
  ```





\- ä¾‹ï¼šComposition ã§ã®æ›¸ãæ–¹





* Setup Stores

  ```ts
  export const useCounterStore = defineStore("counter", () => {
    const count = ref<number>(0);
    const doubleCount = computed(() => count.value * 2);
    function increment() {
      count.value++;
    }
  
    return { count, doubleCount, increment };
  });
  ```





ãã‚Œãã‚Œã‚’è¦‹ã¦ã¿ã¦ç‰¹å¾´çš„ãªã¨ã“ã‚ãŒã„ãã¤ã‹ã‚ã‚‹ã®ã§è¦‹ã¦ãã¾ã—ã‚‡ã†ã€‚

#### ã„ãªããªã£ãŸãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³

Vuexã‚’ä½¿ç”¨ã—ã¦ã„ãŸçš†ã•ã‚“ãªã‚‰æ°—ã¥ãã¨æ€ã„ã¾ã™ãŒã€ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãŒã„ãªããªã‚Šã¾ã—ãŸã€‚
Vuexã§ã¯ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¦ã‚¹ãƒ†ãƒ¼ãƒˆã®å€¤ã‚’æ›´æ–°ã—ã¦ã„ã¾ã—ãŸãŒã€Piniaã§ã¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆãƒ¡ã‚½ãƒƒãƒ‰ï¼‰ã‚’ä½¿ã£ã¦å€¤ã‚’æ›´æ–°ã—ã¾ã™ã€‚  
ãªãŠã€ã“ã®ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã®å»ƒæ­¢ã¯ä»¥ä¸‹ã®ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚Šã¾ã™ã€‚

- ã‚³ãƒ¼ãƒ‰ãŒã‚·ãƒ³ãƒ—ãƒ«ã§ç›´æ„Ÿçš„ã«ãªã‚‹
- TypeScriptã®æ¨è«–ãŒåŠ¹ã

#### Vueãƒ™ãƒ¼ã‚¹ã®è¨˜è¿°æ–¹æ³•

ä¸Šã®ä¾‹ã®ã‚ˆã†ã«æ›¸ãæ–¹ãŒOptionã¨SetupãŒã‚ã‚Šã¾ã™ã€‚  
Vueãƒ¦ãƒ¼ã‚¶ãƒ¼ãªã‚‰ã‚ã‹ã‚‹ã¨æ€ã„ã¾ã™ãŒã€Option API ã¨ Composition APIã®è¨˜è¿°ãƒ™ãƒ¼ã‚¹ãŒé¸ã¹ã‚‹ãŸã‚ã€æ›¸ãå¿ƒåœ°ã¯Vueã‚’æ›¸ã‘ã‚‹äººãªã‚‰ã°æ›¸ãã‚„ã™ã„ã‹ã¨æ€ã„ã¾ã™ã€‚

#### Vuexã¨ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¤ã„ã¦



## å€‹äººçš„ã«æ„Ÿã˜ãŸPiniaã®ãƒ¡ãƒªãƒƒãƒˆ

### ã‚·ãƒ³ãƒ—ãƒ«ã§ç›´æ„Ÿçš„

### Composition APIã¨ç›¸æ€§

### ãƒ†ã‚¹ãƒˆãŒå®¹æ˜“

## ã‚°ãƒ­ãƒ¼ãƒãƒ«ã°ãƒ‡ãƒ¼ã‚¿ã‚’ç®¡ç†ã™ã‚‹æ–¹æ³•ã®æ¯”è¼ƒ

Piniaä»¥å¤–ã«ã€ã€Œã‚°ãƒ­ãƒ¼ãƒãƒ«ã°ãƒ‡ãƒ¼ã‚¿ã‚’ç®¡ç†ã™ã‚‹æ–¹æ³•ã€ã¨ã—ã¦ã¯Vue3ã§ã¯2ã¤ã‚ã‚Šã¾ã™ã€‚

* çŠ¶æ…‹ç®¡ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒª Vuex
* provide/injectã‚ªãƒ—ã‚·ãƒ§ãƒ³

ãã‚Œãã‚Œã«ã¤ã„ã¦ã‚‚æ¯”è¼ƒã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

## Vuexã‹ã‚‰ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¤ã„ã¦











ã“ã‚Œã‚‰ã®ã†ã¡ã€2ã¤







---

Injectã¨Vuexã¨Piniaã«ã¤ã„ã¦ã®æ¯”è¼ƒè¡¨ã‚’ä½œã£ã¦ã»ã—ã„ã¨ã„ã†ã“ã¨ã§ã™ã­ã€‚

Injectã¯Vueã®æ©Ÿèƒ½ã®ä¸€ã¤ã§ã€è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã™ã“ã¨ãŒã§ãã¾ã™ã€‚Vuexã¨Piniaã¯Vueã®çŠ¶æ…‹ç®¡ç†ãƒ„ãƒ¼ãƒ«ã§ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªãƒ‡ãƒ¼ã‚¿ã‚’ç®¡ç†ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ä»¥ä¸‹ã®ã‚ˆã†ãªæ¯”è¼ƒè¡¨ã‚’ä½œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

| é …ç›®             | Inject                                                       | Vuex                                                         | Pinia                                                        |
| :--------------- | :----------------------------------------------------------- | :----------------------------------------------------------- | :----------------------------------------------------------- |
| ãƒ‡ãƒ¼ã‚¿ã®ç¯„å›²     | è¦ªå­é–¢ä¿‚ã®ã‚ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“                               | ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“                                         | ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“                                         |
| ãƒ‡ãƒ¼ã‚¿ã®å®šç¾©æ–¹æ³• | provide/injectã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ä½¿ã†                               | storeã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«stateã‚„mutationsãªã©ã‚’å®šç¾©ã™ã‚‹            | createPiniaé–¢æ•°ã§storeã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œã‚Šã€defineStoreé–¢æ•°ã§å„storeã‚’å®šç¾©ã™ã‚‹ |
| ãƒ‡ãƒ¼ã‚¿ã®å–å¾—æ–¹æ³• | injectã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§å–å¾—ã™ã‚‹                                   | mapStateã‚„mapGettersãªã©ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã‚’ä½¿ã†ã‹ã€this.$store.stateã‚„this.$store.gettersãªã©ã§ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ | useStoreé–¢æ•°ã§å–å¾—ã™ã‚‹                                       |
| ãƒ‡ãƒ¼ã‚¿ã®æ›´æ–°æ–¹æ³• | ç›´æ¥å¤‰æ›´ã™ã‚‹ã‹ã€emitã‚¤ãƒ™ãƒ³ãƒˆã‚’ä½¿ã†                           | mapMutationsã‚„mapActionsãªã©ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°ã‚’ä½¿ã†ã‹ã€this.$store.commitã‚„this.$store.dispatchãªã©ã§å‘¼ã³å‡ºã™ | storeå†…ã§å®šç¾©ã—ãŸãƒ¡ã‚½ãƒƒãƒ‰ã‚„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‘¼ã³å‡ºã™              |
| ç‰¹å¾´ã‚„åˆ©ç‚¹       | [ã‚·ãƒ³ãƒ—ãƒ«ã§ç°¡å˜ã«ä½¿ãˆã‚‹ã€‚Composition APIã§ã‚‚åŒã˜ã‚ˆã†ã«ä½¿ãˆã‚‹ã€‚](https://qiita.com/__Nem__/items/4b2c8b99fb245dcff80c)[1](https://qiita.com/__Nem__/items/4b2c8b99fb245dcff80c) | Vue2ã§ã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®çŠ¶æ…‹ç®¡ç†ãƒ„ãƒ¼ãƒ«ã€‚è±Šå¯Œãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚„ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒã‚ã‚‹ã€‚Options APIã¨ç›¸æ€§ãŒè‰¯ã„ã€‚[2](https://www.telerik.com/blogs/vue-js-state-management-pinia-vs-vuex)[3](https://blog.logrocket.com/pinia-vs-vuex/)[4](https://pinia.vuejs.org/introduction.html)[1](https://qiita.com/__Nem__/items/4b2c8b99fb245dcff80c) | [Vue3ã§ã¯æ¨å¥¨ã•ã‚Œã‚‹çŠ¶æ…‹ç®¡ç†ãƒ„ãƒ¼ãƒ«ã€‚ã‚·ãƒ³ãƒ—ãƒ«ã§ç›´æ„Ÿçš„ãªè¨˜è¿°ãŒã§ãã‚‹ã€‚Composition APIã¨ç›¸æ€§ãŒè‰¯ã„ã€‚Vue devtoolsã¨é€£æºã—ã¦é–‹ç™ºä½“é¨“ã‚’å‘ä¸Šã•ã›ã‚‹ã€‚](https://www.telerik.com/blogs/vue-js-state-management-pinia-vs-vuex)[2](https://www.telerik.com/blogs/vue-js-state-management-pinia-vs-vuex)[3](https://blog.logrocket.com/pinia-vs-vuex/)[4](https://pinia.vuejs.org/introduction.html)[1](https://qiita.com/__Nem__/items/4b2c8b99fb245dcff80c) |

ä»¥ä¸ŠãŒç§ã®ææ¡ˆã§ã™ã€‚ã”å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚ğŸ™





---

Vueã§ã‚°ãƒ­ãƒ¼ãƒãƒ«ãªãƒ‡ãƒ¼ã‚¿ã‚’ç®¡ç†ã™ã‚‹æ–¹æ³•ã®å›³ã‚’Injectã¨Vuexã¨Piniaãã‚Œãã‚Œã§æ›¸ã„ã¦ã»ã—ã„ã¨ã„ã†ã“ã¨ã§ã™ã­ã€‚

ä»¥ä¸‹ã®ã‚ˆã†ãªå›³ã‚’ä½œã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

Injectã®å ´åˆï¼š

```
+-----------------+       +-----------------+
| è¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ |       | å­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ |
|                 |       |                 |
| provide: {      |       | inject: ["data"]|
|   data: "Hello" | ----> |                 |
| }               |       |                 |
+-----------------+       +-----------------+
```

Vuexã®å ´åˆï¼š

```
+-----------------+       +-----------------+
| Vuex store      | <---->| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ   |
|                 |       |                 |
| state: {        |       | computed: {     |
|   data: "Hello" | ----> |   data() {      |
| }               |       |     return this.|
|                 |       |     $store.state|
| mutations: {    | <---- |     .data;      |
|   setData(state,| ----> |   }             |
|   payload) {    |       | },              |
|     state.data =|       | methods: {      |
|     payload;    |       |   setData() {   |
|   }             |       |     this.$store.|
| }               |       |     commit("setD|
+-----------------+       +-----------------+ ata", "World");  |
                         +-----------------+
```

Piniaã®å ´åˆï¼š

```
+-----------------+       +-----------------+
| Pinia store     | <---->| ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ   |
|                 |       |                 |
| id: "myStore",  |       | setup() {       |
| state: () => ({ |       |   const store = |
|   data: "Hello" | ----> |   useStore("mySt|
| }),             |       |   ore");        |
| actions: {      | <---- |   return {      |
|   setData(data) {       |     data: store.|
|     this.data = | ----> |     data,       |
|     data;               |     setData:    |
|   }             |       |     store.setDat|
+-----------------+       +-----------------+ a                |
                         +-----------------+
```

ã“ã®å›³ã§ã¯ã€Pinia storeã®id, state, actionsã‚’ç¤ºã—ã¦ã„ã¾ã™ã€‚ã¾ãŸã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®setupé–¢æ•°ã§useStoreé–¢æ•°ã‚’ä½¿ã£ã¦storeã‚’å–å¾—ã—ã€dataã¨setDataã‚’è¿”ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰storeã®çŠ¶æ…‹ã‚„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã™ã€‚

ä»¥ä¸ŠãŒç§ã®ææ¡ˆã§ã™ã€‚ã”å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚ğŸ™







----



Vue2ã‹ã‚‰Vue3ã«ç§»è¡Œã™ã‚‹ã«ã‚ãŸã£ã¦ã€çŠ¶æ…‹é·ç§»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’Piniaã«å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã¨ã„ã†è©±ã‚’èã„ãŸã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã§ã¯ã€ãªãœPiniaã«å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿãã®ç†ç”±ã‚’ç°¡å˜ã«èª¬æ˜ã—ã¾ã™ã€‚

ã¾ãšã€Piniaã¯Vue3ã§æ¨å¥¨ã•ã‚Œã¦ã„ã‚‹çŠ¶æ…‹ç®¡ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚Vue3ã¯TypeScriptã§é–‹ç™ºã•ã‚Œã¦ãŠã‚Šã€å‹æ¨è«–ãŒåŠ¹ãã‚„ã™ããªã£ã¦ã„ã¾ã™ã€‚Piniaã‚‚TypeScriptã®ãƒ•ãƒ«ã‚µãƒãƒ¼ãƒˆã‚’ã—ã¦ãŠã‚Šã€Vuex4ã¨æ¯”è¼ƒã—ã¦ã‚‚å‹å®‰å…¨æ€§ãŒé«˜ã„ã§ã™ã€‚

æ¬¡ã«ã€Piniaã¯Composition APIã¨ç›¸æ€§ãŒè‰¯ã„ã§ã™ã€‚Composition APIã¯Vue3ã§æ¨å¥¨ã•ã‚Œã‚‹æ›¸ãæ–¹ã§ã€ãƒ­ã‚¸ãƒƒã‚¯ã‚’1ç®‡æ‰€ã«ã¾ã¨ã‚ã‚„ã™ãã€å˜ä½“ãƒ†ã‚¹ãƒˆãŒæ›¸ãã‚„ã™ã„ã§ã™ã€‚Piniaã§ã¯ã€storeã‚’è¤‡æ•°ã«åˆ†ã‘ã¦ç®¡ç†ã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€å¿…è¦ãªstoreã®ã¿å‘¼ã³å‡ºã—ã¦ä½¿ç”¨ã§ãã¾ã™ã€‚

æœ€å¾Œã«ã€Piniaã¯ä»Šå¾Œã®ä¸»æµã«ãªã‚Šãã†ã§ã™ã€‚Vue2ã§ã‚ˆãä½¿ã‚ã‚ŒãŸClass Componentã¯éæ¨å¥¨ã«ã™ã‚‹æ¡ˆãŒå‡ºã¦ãŠã‚Šã€é–‹ç™ºãƒªãƒã‚¸ãƒˆãƒªã‚‚æ›´æ–°ãŒæ­¢ã¾ã£ã¦ã„ã¾ã™ ã€‚ä¸€æ–¹ã€Piniaã¯ç©æ¥µçš„ã«é–‹ç™ºã•ã‚Œã¦ãŠã‚Šã€æ–°ã—ã„æ©Ÿèƒ½ã‚„æ”¹å–„ãŒæœŸå¾…ã§ãã¾ã™ã€‚

ä»¥ä¸Šã®ç†ç”±ã‹ã‚‰ã€Vue2ã‹ã‚‰Vue3ã¸ã®ç§»è¡Œæ™‚ã«ã¯çŠ¶æ…‹é·ç§»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’Piniaã«å¤‰æ›´ã™ã‚‹ã“ã¨ãŒæœ›ã¾ã—ã„ã¨è¨€ãˆã¾ã™ã€‚



---

// piniaã®ãƒ†ã‚¹ãƒˆã‚’è¡Œã†ãŸã‚ã«ã¯ã€ã¾ãšpiniaã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦Vueãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ ã€‚
// ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§piniaã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚
npm install pinia

// main.jsãƒ•ã‚¡ã‚¤ãƒ«ã«piniaã‚’ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã¨ã—ã¦è¿½åŠ ã—ã¾ã™ã€‚
import { createApp } from 'vue'
import { createPinia } from 'pinia'
import App from './App.vue'

const app = createApp(App)
app.use(createPinia())
app.mount('#app')

// æ¬¡ã«ã€storesãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ã¦ã€å…±æœ‰ã—ãŸã„ãƒ‡ãƒ¼ã‚¿ã‚„ãƒ¡ã‚½ãƒƒãƒ‰ã‚’æŒã¤storeãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®šç¾©ã—ã¾ã™ ã€‚
// ä¾‹ãˆã°ã€ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼æ©Ÿèƒ½ã®storeã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
import { defineStore } from 'pinia';

export const useStoreCounter = defineStore('counter', {
  state: () => ({
    count: 1,
  }),
});

// storeãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ãŸã‚‰ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰importã—ã¦åˆ©ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ ã€‚
// ä¾‹ãˆã°ã€ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼æ©Ÿèƒ½ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
<template>
  <div>
    <p>Count: {{ count }}</p>
    <button @click="increment">+1</button>
    <button @click="decrement">-1</button>
  </div>
</template>

<script>
import { useStoreCounter } from '../stores/counter.js'

export default {
  setup() {
    // storeã‹ã‚‰countã¨incrementãƒ¡ã‚½ãƒƒãƒ‰ã¨decrementãƒ¡ã‚½ãƒƒãƒ‰ã‚’å–å¾—ã—ã¾ã™ã€‚
    const { count, increment, decrement } = useStoreCounter()

    return {
      count,
      increment,
      decrement
    }
  }
}
</script>

// piniaã§ã¯ã€storeã®çŠ¶æ…‹ã‚„å¤‰æ›´ãŒVue devtoolsã§ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™  ã€‚
// ãƒ–ãƒ©ã‚¦ã‚¶ã§Vue devtoolsã‚’é–‹ã„ã¦ã€Piniaã‚¿ãƒ–ã‚’é¸æŠã™ã‚‹ã¨ã€storeã®idã‚„stateã‚„actionsãªã©ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚





---

ã€ŒTesting Storesã€ãƒšãƒ¼ã‚¸ã®ã€ŒUnit testing a storeã€ã¨ã€ŒUnit testing componentsã€ã¯ã€ã‚¹ãƒˆã‚¢ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ãŸã‚ã®ç•°ãªã‚‹æ–¹æ³•ã§ã™ã€‚ã€ŒUnit testing a storeã€ã¯ã‚¹ãƒˆã‚¢ã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã€ã€ŒUnit testing componentsã€ã¯ã‚¹ãƒˆã‚¢ã‚’ä½¿ç”¨ã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚



---



# createTestingPiniaã®ä½¿ã„æ–¹

ã“ã‚“ã«ã¡ã¯ï¼ä»Šæ—¥ã¯ã€Vue.jsã§ãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆã‚¢ã‚’ä½œã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã‚ã‚‹Piniaã®ãƒ†ã‚¹ãƒˆã«ã¤ã„ã¦ç´¹ä»‹ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚Piniaã¯Vuexã®ä»£æ›¿ã¨ã—ã¦äººæ°—ãŒé«˜ã¾ã£ã¦ã„ã¾ã™ãŒã€ãƒ†ã‚¹ãƒˆã™ã‚‹éš›ã«ã¯å°‘ã—å·¥å¤«ãŒå¿…è¦ã§ã™ã€‚ãã“ã§ã€@pinia/testingã¨ã„ã†ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦ã€ç°¡å˜ã«ã‚¹ãƒˆã‚¢ã‚’ãƒ¢ãƒƒã‚¯ã™ã‚‹æ–¹æ³•ã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

## @pinia/testingã¨ã¯ï¼Ÿ

@pinia/testingã¯ã€Piniaã®å…¬å¼ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã€ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆç”¨ã«è¨­è¨ˆã•ã‚ŒãŸpiniaã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã™ã‚‹é–¢æ•°createTestingPiniaã‚’æä¾›ã—ã¾ã™ã€‚ã“ã®é–¢æ•°ã¯ä»¥ä¸‹ã®ç‰¹å¾´ãŒã‚ã‚Šã¾ã™ã€‚

- ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ã€ã™ã¹ã¦ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãŒãƒ¢ãƒƒã‚¯ã•ã‚Œã¦ãŠã‚Šã€å®Ÿè¡Œã•ã‚Œã¾ã›ã‚“ã€‚
- Jestã‚’ä½¿ã£ã¦ã„ã‚‹å ´åˆã¯jest.fn()ã§ç½®ãæ›ãˆã‚‰ã‚Œã¾ã™ã€‚
- stubActionsã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®æŒ™å‹•ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã¾ã™ã€‚
- createSpyã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§è‡ªåˆ†ã§ã‚¹ãƒ‘ã‚¤é–¢æ•°ã‚’æŒ‡å®šã§ãã¾ã™ã€‚
- initialStateã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã‚¹ãƒˆã‚¢ã®åˆæœŸçŠ¶æ…‹ã‚’è¨­å®šã§ãã¾ã™ã€‚

## ä½¿ã„æ–¹

@pinia/testingã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

shell
npm i -D @pinia/testing
\```

ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚„ã‚¹ãƒˆã‚¢ã®ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«å†…ã§createTestingPiniaã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚

\```js
import { createTestingPinia } from '@pinia/testing'
\```

ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ãƒã‚¦ãƒ³ãƒˆã™ã‚‹éš›ã«global.pluginsã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«createTestingPinia()ã‚’æ¸¡ã—ã¾ã™ã€‚

\```js
import { mount } from '@vue/test-utils'
import { createTestingPinia } from '@pinia/testing'
import MyComponent from '@/components/MyComponent.vue'

const wrapper = mount(MyComponent, {
global: {
plugins: [createTestingPinia()],
},
})
\```

ãƒ†ã‚¹ãƒˆå†…ã§useStore()ãªã©ã®é–¢æ•°ã‚’å‘¼ã³å‡ºã™ã¨ã€createTestingPinia()ãŒä½œæˆã—ãŸpiniaã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šä»¥ä¸‹ã®ã“ã¨ãŒå¯èƒ½ã§ã™ã€‚

\- ã‚¹ãƒˆã‚¢ã®çŠ¶æ…‹(state)ã‚„ã‚²ãƒƒã‚¿ãƒ¼(getters)ã«ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦å€¤ã‚’ç¢ºèªã—ãŸã‚Šå¤‰æ›´ã—ãŸã‚Šã§ãã¾ã™ã€‚
\- ã‚¹ãƒˆã‚¢ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³(actions)ã¯å‘¼ã³å‡ºã•ã‚ŒãŸå›æ•°ã‚„å¼•æ•°ãªã©ã‚’æ¤œè¨¼ã§ãã¾ã™ã€‚
\- ã‚¹ãƒˆã‚¢ã®åˆæœŸçŠ¶æ…‹(initialState)ã‚„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³(actions)ã®æŒ™å‹•(stubActions)ãªã©ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã§ãã¾ã™ã€‚

ä¾‹ãˆã°ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ãŒæ›¸ã‘ã¾ã™ã€‚



\```js
import { useCounterStore } from '@/stores/counter'

// ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã§ã¯useCounterStore()ãŒå‘¼ã°ã‚Œã¦ã„ã¾ã™

test('increments the counter', async () => {
const store = useCounterStore()
expect(store.count).toBe(0)
await wrapper.find('button').trigger('click')
expect(store.count).toBe(1)
expect(store.increment).toHaveBeenCalledTimes(1)
})

test('resets the counter', async () => {
const store = useCounterStore()
store.count = 10 // ç›´æ¥å€¤ã‚’å¤‰æ›´
await wrapper.find('button.reset').trigger('click')
expect(store.count).toBe(0)
})
\```







---

- `ref()`s become `state` properties
- `computed()`s become `getters`
- `function()`s become `actions`
